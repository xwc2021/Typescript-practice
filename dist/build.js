(()=>{"use strict";const t=function(t,e){this.from=t,this.dir=e};function e(t){return Math.PI*t/180}function n(t,e){return Math.abs(t-e)<.001}function i(t,e){return t.map((function(t){return t.h.hit(e,t.s)})).filter((function(t){return t.is_hit})).sort((function(t,e){return t.t-e.t}))}function r(t,e,n){return t+n*(e-t)}function s(t,e){var n=[],i=function(t,e,n){var i=t.p,s=e.p,a=(n-i.z)/(s.z-i.z),h=r(i.x,s.x,a),u=r(i.y,s.y,a),c=t.uv,l=e.uv,v=r(c.x,l.x,a),f=r(c.y,l.y,a);return new o(h,u,n,v,f)},s=function(t,r,s){n[0]=t,n[1]=i(t,r,e),n[2]=i(t,s,e)},a=function(t,r,s){var a=i(s,t,e),o=i(t,r,e);n[0]=s,n[1]=a,n[2]=o,n[3]=s.copy(),n[4]=o,n[5]=r};return t.v0.p.z<e?t.v1.p.z<e?t.v2.p.z<e||s(t.v2,t.v0,t.v1):t.v2.p.z<e?s(t.v1,t.v2,t.v0):a(t.v0,t.v1,t.v2):t.v1.p.z<e?t.v2.p.z<e?s(t.v0,t.v1,t.v2):a(t.v1,t.v2,t.v0):t.v2.p.z<e?a(t.v2,t.v0,t.v1):(n[0]=t.v0,n[1]=t.v1,n[2]=t.v2),n}const a=function(){function t(t,e,n){this.x=0,this.y=0,this.z=0,this.x=t,this.y=e,this.z=n}return t.uv=function(e,n){return new t(e,n,0)},t.reflect=function(e,n){var i=-2*t.dot(e,n);return n.multiply(i).add(e)},t.add=function(e,n){return new t(n.x+e.x,n.y+e.y,n.z+e.z)},t.minus=function(e,n){return new t(e.x-n.x,e.y-n.y,e.z-n.z)},t.multiply=function(e,n){return new t(e.x*n,e.y*n,e.z*n)},t.multiply3=function(e,n){return new t(e.x*n.x,e.y*n.y,e.z*n.z)},t.cross=function(e,n){return new t(e.y*n.z-e.z*n.y,-e.x*n.z+e.z*n.x,e.x*n.y-e.y*n.x)},t.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},t.equal=function(t,e){return n(t.x,e.x)&&n(t.y,e.y)&&n(t.z,e.z)},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.normalize=function(){var t=this.length();return this.x=this.x/t,this.y=this.y/t,this.z=this.z/t,this},t.prototype.add=function(e){return t.add(this,e)},t.prototype.minus=function(e){return t.minus(this,e)},t.prototype.multiply=function(e){return t.multiply(this,e)},t.prototype.negative=function(){return t.multiply(this,-1)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.up=new t(0,1,0),t.zero=new t(0,0,0),t}(),o=function(){function t(t,e,n,i,r){this.p=new a(t,e,n),this.uv=new a(i,r,0)}return t.build_vertex=function(e,n){return new t(e.x,e.y,e.z,n.x,n.y)},t.prototype.copy=function(){return t.build_vertex(this.p,this.uv)},t}(),h=function(){function t(t,e,n,i){this.xAxis=t,this.yAxis=e,this.zAxis=n,this.position=i}return t.transformPoint=function(t,e){var n=t.xAxis.multiply(e.x),i=t.yAxis.multiply(e.y),r=t.zAxis.multiply(e.z);return t.position.add(n).add(i).add(r)},t.transformVector=function(t,e){var n=t.xAxis.multiply(e.x),i=t.yAxis.multiply(e.y),r=t.zAxis.multiply(e.z);return n.add(i).add(r)},t.transformTransform=function(e,n){return new t(t.transformVector(e,n.xAxis),t.transformVector(e,n.yAxis),t.transformVector(e,n.zAxis),t.transformPoint(e,n.position))},t.rotateByZ=function(n){var i=e(n),r=Math.cos(i),s=Math.sin(i);return new t(new a(r,s,0),new a(-s,r,0),new a(0,0,1),a.zero)},t.rotateByX=function(n){var i=e(n),r=Math.cos(i),s=Math.sin(i);return new t(new a(1,0,0),new a(0,r,s),new a(0,-s,r),new a(0,0,0))},t.offset=function(e,n,i){return new t(new a(1,0,0),new a(0,1,0),new a(0,0,1),new a(e,n,i))},t}(),u=function(){function t(t,e,n){this.v0=t,this.v1=e,this.v2=n}return t.process=function(e,n,i){var r=h.transformPoint(i,e.v0.p),u=h.transformPoint(i,e.v1.p),c=h.transformPoint(i,e.v2.p),l=n.toCameraSpace(r),v=n.toCameraSpace(u),f=n.toCameraSpace(c),y=a.minus(v,l),p=a.minus(f,l),d=a.cross(p,y);d.normalize();var x=l.add(v).add(f).multiply(1/3),m=a.minus(a.zero,x);if(m.normalize(),a.dot(d,m)<=0)return null;for(var w=s(new t(o.build_vertex(l,e.v0.uv),o.build_vertex(v,e.v1.uv),o.build_vertex(f,e.v2.uv)),1),_=[],z=0;z<w.length;++z)_[z]=n.toScreenSpace(w[z].p);return _},t.prototype.process=function(e,n){this.v_s=t.process(this,e,n)},t.prototype.draw=function(t){if(null!=this.v_s)for(var e=this.v_s.length/3,n=1;n<=e;++n){var i=3*n-1;t.moveTo(this.v_s[i].x,this.v_s[i].y),t.lineTo(this.v_s[i-2].x,this.v_s[i-2].y),t.lineTo(this.v_s[i-1].x,this.v_s[i-1].y),t.lineTo(this.v_s[i].x,this.v_s[i].y)}},t}(),c=function(){function t(){this.triangles=[],this.triangles.push(new u(o.build_vertex(new a(-10,-10,-10),a.uv(0,0)),o.build_vertex(new a(10,-10,10),a.uv(1,1)),o.build_vertex(new a(10,-10,-10),a.uv(1,0)))),this.triangles.push(new u(o.build_vertex(new a(-10,-10,-10),a.uv(0,0)),o.build_vertex(new a(-10,-10,10),a.uv(0,1)),o.build_vertex(new a(10,-10,10),a.uv(1,1))));for(var t=[h.rotateByZ(90),h.rotateByZ(180),h.rotateByZ(270),h.rotateByX(90),h.rotateByX(-90)],e=0;e<t.length;++e){var n=t[e];this.triangles.push(new u(o.build_vertex(h.transformPoint(n,new a(-10,-10,-10)),a.uv(0,0)),o.build_vertex(h.transformPoint(n,new a(10,-10,10)),a.uv(1,1)),o.build_vertex(h.transformPoint(n,new a(10,-10,-10)),a.uv(1,0)))),this.triangles.push(new u(o.build_vertex(h.transformPoint(n,new a(-10,-10,-10)),a.uv(0,0)),o.build_vertex(h.transformPoint(n,new a(-10,-10,10)),a.uv(0,1)),o.build_vertex(h.transformPoint(n,new a(10,-10,10)),a.uv(1,1))))}}return t.prototype.update=function(t,e){this.triangles_after_clip=[];for(var n=0;n<this.triangles.length;++n)for(var i=s(this.triangles[n],-1),r=i.length/3,a=0;a<r;++a){var o=new u(i[3*a],i[3*a+1],i[3*a+2]);this.triangles_after_clip.push(o)}for(this.triangles_after_clip=this.triangles,n=0;n<this.triangles_after_clip.length;++n)this.triangles_after_clip[n].process(t,e)},t.prototype.draw=function(t){t.globalCompositeOperation="destination-over",t.strokeStyle="rgba(255,0,0,1)",t.beginPath();for(var e=0;e<this.triangles_after_clip.length;++e)this.triangles_after_clip[e].draw(t);t.stroke()},t}(),l=function(){function e(t){this.color=t}return e.prototype.shading=function(e,n,r,s){var o,h=e.normal,u=(0,(o=-a.dot(n,h))>1?1:o<0?0:o),c=function(e,n,r){var s=n.negative(),a=e.hit_pos.add(s.multiply(.001));return 0!=i(r,new t(a,s)).length?.45:1}(e,n,r);return this.color.multiply(u).multiply(c)},e.yellow=new e(new a(1,1,0)),e.red=new e(new a(1,0,0)),e.green=new e(new a(0,1,0)),e.blue=new e(new a(0,0,1)),e.gray=new e(new a(.5,.5,.5)),e.white=new e(new a(1,1,1)),e}(),v=function(){function n(t,n,i,r,s){this.moveEye=function(t,e){this.eye=a.add(this.eye,e.multiply(t))},this.toScreenSpace=function(t){var n=-t.z,i=.5*e(this.fov_degree),r=1/Math.tan(i),s=1/(this.ratio*Math.tan(i)),o=t.x*s/n,h=t.y*r/n,u=this.halfW*o+this.screenCenterX,c=-this.halfH*h+this.screenCenterY;return new a(u,c,n)},this.ratio=r/s,this.screenW=r,this.screenH=s,this.screenCenterX=.5*this.screenW,this.screenCenterY=.5*this.screenH,this.halfW=.5*this.screenW,this.halfH=.5*this.screenH,this.z_axis=a.minus(n,t).normalize();var o=a.up;this.x_axis=a.cross(o,this.z_axis).normalize(),this.y_axis=a.cross(this.z_axis,this.x_axis),this.eye=t,this.fov_degree=i}return n.prototype.addPitch=function(t){},n.prototype.addYaw=function(t){},n.prototype.create_ray_dir=function(t,n,i){var r=e(.5*this.fov_degree),s=Math.tan(r),a=s*i;return this.z_axis.add(this.x_axis.multiply(t*a)).add(this.y_axis.multiply(n*s))},n.prototype.toCameraSpace=function(t){var e=t.minus(this.eye);return new a(a.dot(e,this.x_axis),a.dot(e,this.y_axis),a.dot(e,this.z_axis))},n.prototype.render=function(e,n){var r=this,s=new a(1,-1,0).normalize(),o=.5/e.h,h=[{x:0,y:0},{x:o,y:o},{x:-o,y:o},{x:-o,y:-o},{x:o,y:-o}];e.render_pixel((function(e,o,u){var c=r.create_ray_dir(e,o,u),v=h.map((function(e){var n=c.add(r.x_axis.multiply(e.x)).add(r.y_axis.multiply(e.y));return new t(r.eye,n.normalize())})).map((function(t){var e=i(n,t);if(0!=e.length){var r=e[0];return r.s.shading(r,s,n,1)}return l.gray.color})),f=h.length;return v.reduce((function(t,e){return t.add(e)}),a.zero).multiply(1/f)}))},n}();new(function(){function t(){var t=this;this.cameraIndex_view=1,this.cameraIndex_control=0,this.camera=null,this.screenWidth=800,this.screenHeight=600,this.box=null,window.onload=function(){t.init()},document.onkeydown=this.keyProc}return t.prototype.init=function(){var t=document.getElementById("canvas");t.style.width=this.screenWidth+"px",t.style.height=this.screenHeight+"px",t.width=t.clientWidth,t.height=t.clientHeight,this.ctx=t.getContext("2d"),this.box=new c,this.camera=new v(new a(0,250,-20),new a(0,0,0),60,this.screenWidth,this.screenHeight),this.start()},t.prototype.start=function(){var t=this;this.stop(),this.sum_t=0;var e=new Date;this.last_t=e.getTime(),this.thandle=window.setInterval((function(){t.drawScene()}),16)},t.prototype.resume=function(){var t=this,e=new Date;this.last_t=e.getTime(),this.thandle=window.setInterval((function(){t.drawScene()}),16)},t.prototype.stop=function(){window.clearInterval(this.thandle),this.thandle=null},t.prototype.drawScene=function(){var t=(new Date).getTime(),e=t-this.last_t;this.last_t=t,this.sum_t=this.sum_t+e,this.ctx.clearRect(0,0,this.screenWidth,this.screenHeight);var n=h.offset(0,0,0),i=this.sum_t/1e3*15%360,r=h.rotateByZ(i),s=h.transformTransform(n,r);this.box.update(this.camera,s),this.box.draw(this.ctx),n=h.offset(150,0,0),r=h.rotateByZ(i),s=h.transformTransform(r,n),this.box.update(this.camera,s),this.box.draw(this.ctx)},t.prototype.keyProc=function(t){switch(t.keyCode){case 87:this.camera.moveEye(1,this.camera.z_axis);break;case 82:this.camera.moveEye(-1,this.camera.z_axis);break;case 69:this.camera.moveEye(1,this.camera.y_axis);break;case 68:this.camera.moveEye(-1,this.camera.y_axis);break;case 83:this.camera.moveEye(-1,this.camera.x_axis);break;case 70:this.camera.moveEye(1,this.camera.x_axis);break;case 38:this.camera.addPitch(.1);break;case 40:this.camera.addPitch(-.1);break;case 37:this.camera.addYaw(-.1);break;case 39:this.camera.addYaw(.1)}},t}())})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQ3ZDQyxFQUFnQixxQkFBNkJ0RyxFQUFjb0csR0FDM0RsTyxLQUFLdU0sSUFBSXhFLE9BQU8vSCxLQUFLZ0ksT0FBUW9HLEdBQzdCcE8sS0FBS3VNLElBQUlsRixLQUFLckgsS0FBS3NILE1BR3ZCLFlBQUF1RixRQUFBLFNBQVF3QixHQW1CSixPQUFRQSxFQUFNQyxTQUNWLEtBakJHLEdBa0JDdE8sS0FBS2dJLE9BQU8rQixRQUpSLEVBSXVCL0osS0FBS2dJLE9BQU8yQyxRQUN2QyxNQUNKLEtBbkJHLEdBb0JDM0ssS0FBS2dJLE9BQU8rQixTQVBSLEVBT3dCL0osS0FBS2dJLE9BQU8yQyxRQUN4QyxNQUVKLEtBckJHLEdBc0JDM0ssS0FBS2dJLE9BQU8rQixRQVhSLEVBV3VCL0osS0FBS2dJLE9BQU84QyxRQUN2QyxNQUNKLEtBdkJHLEdBd0JDOUssS0FBS2dJLE9BQU8rQixTQWRSLEVBY3dCL0osS0FBS2dJLE9BQU84QyxRQUN4QyxNQUNKLEtBekJHLEdBMEJDOUssS0FBS2dJLE9BQU8rQixTQWpCUixFQWlCd0IvSixLQUFLZ0ksT0FBTzZDLFFBQ3hDLE1BQ0osS0EzQkcsR0E0QkM3SyxLQUFLZ0ksT0FBTytCLFFBcEJSLEVBb0J1Qi9KLEtBQUtnSSxPQUFPNkMsUUFDdkMsTUFFSixLQTdCTSxHQThCRjdLLEtBQUtnSSxPQUFPK0MsU0F2Qk4sSUF3Qk4sTUFDSixLQS9CUSxHQWdDSi9LLEtBQUtnSSxPQUFPK0MsVUFBUyxJQUNyQixNQUVKLEtBbENRLEdBbUNKL0ssS0FBS2dJLE9BQU9nRCxRQUFPLElBQ25CLE1BQ0osS0FwQ1MsR0FxQ0xoTCxLQUFLZ0ksT0FBT2dELE9BakNOLE1BcUN0QixFQXpJQSxLIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViZ2xfdGVzdC8uL3NyYy9NYXRoL1JheS50cyIsIndlYnBhY2s6Ly93ZWJnbF90ZXN0Ly4vc3JjL01hdGgvVG9vbC50cyIsIndlYnBhY2s6Ly93ZWJnbF90ZXN0Ly4vc3JjL01hdGgvVmVjdG9yLnRzIiwid2VicGFjazovL3dlYmdsX3Rlc3QvLi9zcmMvTWF0aC9WZXJ0ZXgudHMiLCJ3ZWJwYWNrOi8vd2ViZ2xfdGVzdC8uL3NyYy9NYXRoL1RyYW5zZm9ybS50cyIsIndlYnBhY2s6Ly93ZWJnbF90ZXN0Ly4vc3JjL01hdGgvVHJpYW5nbGUudHMiLCJ3ZWJwYWNrOi8vd2ViZ2xfdGVzdC8uL3NyYy9NYXRoL0JveDNELnRzIiwid2VicGFjazovL3dlYmdsX3Rlc3QvLi9zcmMvTWF0ZXJhaWxzL0RpZmZ1c2UudHMiLCJ3ZWJwYWNrOi8vd2ViZ2xfdGVzdC8uL3NyYy9NYXRoL0NhbWVyYS50cyIsIndlYnBhY2s6Ly93ZWJnbF90ZXN0Ly4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vd2ViZ2xfdGVzdC8uL3NyYy9SYXN0ZXJpemVyQXBwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBWZWNvciBmcm9tIFwiLi9WZWN0b3JcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJheSB7XHJcbiAgICBmcm9tOiBWZWNvcjtcclxuICAgIGRpcjogVmVjb3I7XHJcblxyXG4gICAgY29uc3RydWN0b3IoZnJvbTogVmVjb3IsIGRpcjogVmVjb3IpIHtcclxuICAgICAgICB0aGlzLmZyb20gPSBmcm9tO1xyXG4gICAgICAgIHRoaXMuZGlyID0gZGlyO1xyXG4gICAgfVxyXG59OyIsImltcG9ydCBTY2VuZU5vZGUgZnJvbSBcIi4uL09iamVjdC9TY2VuZU5vZGVcIjtcclxuaW1wb3J0IFJheSBmcm9tIFwiLi9SYXlcIjtcclxuaW1wb3J0IEhpdEluZm8gZnJvbSBcIi4vSGl0SW5mb1wiO1xyXG5pbXBvcnQgVmVjdG9yIGZyb20gXCIuL1ZlY3RvclwiO1xyXG5pbXBvcnQgVHJpYW5nbGUgZnJvbSBcIi4vVHJpYW5nbGVcIjtcclxuaW1wb3J0IFZlcnRleCBmcm9tIFwiLi9WZXJ0ZXhcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkZWdyZWVfdG9fUmFkKGQ6IG51bWJlcikge1xyXG4gICAgcmV0dXJuIE1hdGguUEkgKiBkIC8gMTgwO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVwc2lsb246IG51bWJlciA9IDAuMDAxO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG51bWJlcl9lcXVhbChhOiBudW1iZXIsIGI6IG51bWJlcikge1xyXG4gICAgcmV0dXJuIE1hdGguYWJzKGEgLSBiKSA8IGVwc2lsb247XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBcclxuICogQHBhcmFtIHggaW5wdXRcclxuICogQHBhcmFtIGEgbWluIFxyXG4gKiBAcGFyYW0gYiBtYXhcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGFtcCh4OiBudW1iZXIsIGE6IG51bWJlciwgYjogbnVtYmVyKSB7XHJcbiAgICBpZiAoeCA+IGIpXHJcbiAgICAgICAgcmV0dXJuIGI7XHJcbiAgICBlbHNlIGlmICh4IDwgYSlcclxuICAgICAgICByZXR1cm4gYTtcclxuICAgIGVsc2VcclxuICAgICAgICByZXR1cm4geDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldF9oaXRfc29ydF9saXN0KG9ial9saXN0OiBTY2VuZU5vZGVbXSwgcmF5OiBSYXkpIHtcclxuICAgIGxldCBoaXRfc29ydF9saXN0ID0gb2JqX2xpc3QubWFwKG9iaiA9PiBvYmouaC5oaXQocmF5LCBvYmoucykpXHJcbiAgICAgICAgLmZpbHRlcihpbmZvID0+IGluZm8uaXNfaGl0KVxyXG4gICAgICAgIC5zb3J0KChhOiBIaXRJbmZvLCBiOiBIaXRJbmZvKSA9PiBhLnQgLSBiLnQpO1xyXG5cclxuICAgIHJldHVybiBoaXRfc29ydF9saXN0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0X3NoYWRvd193ZWlnaHQoaGl0X2luZm86IEhpdEluZm8sIGRpcmVjdGlvbl9saWdodF9kaXI6IFZlY3Rvciwgb2JqX2xpc3Q6IFNjZW5lTm9kZVtdKSB7XHJcblxyXG4gICAgLy8g5piv5ZCm5Zyo5b2x5a2Q5YWnXHJcbiAgICBsZXQgZGlyID0gZGlyZWN0aW9uX2xpZ2h0X2Rpci5uZWdhdGl2ZSgpO1xyXG4gICAgbGV0IGZyb20gPSBoaXRfaW5mby5oaXRfcG9zLmFkZChkaXIubXVsdGlwbHkoZXBzaWxvbikpOyAvLyDlgY/np7vkuIDlsI/mrrXot53pm6LvvIzpgb/lhY3lsITkuK3oh6rlt7FcclxuICAgIGxldCByYXkgPSBuZXcgUmF5KGZyb20sIGRpcik7XHJcbiAgICBsZXQgaGl0X3NvcnRfbGlzdCA9IGdldF9oaXRfc29ydF9saXN0KG9ial9saXN0LCByYXkpO1xyXG4gICAgaWYgKGhpdF9zb3J0X2xpc3QubGVuZ3RoICE9IDApIHsgLy8g5Zyo5b2x5a2Q5YWnXHJcbiAgICAgICAgcmV0dXJuIDAuNDU7IC8vIOS4jeimgeWkqum7kVxyXG4gICAgfSBlbHNlXHJcbiAgICAgICAgcmV0dXJuIDE7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBsZXJwKGE6IG51bWJlciwgYjogbnVtYmVyLCB0OiBudW1iZXIpIHtcclxuICAgIHJldHVybiBhICsgdCAqIChiIC0gYSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGlwKHRyaWFuZ2xlOiBUcmlhbmdsZSwgbmVhclBsYW5lWjogbnVtYmVyKSB7XHJcblxyXG4gICAgbGV0IHZfY2xpcDogVmVydGV4W10gPSBbXTtcclxuXHJcbiAgICBsZXQgZ2V0Q3Jvc3NQb2ludCA9IGZ1bmN0aW9uICh2MDogVmVydGV4LCB2MTogVmVydGV4LCBwejogbnVtYmVyKSB7XHJcblxyXG4gICAgICAgIGxldCBwdjAgPSB2MC5wO1xyXG4gICAgICAgIGxldCBwdjEgPSB2MS5wO1xyXG4gICAgICAgIGxldCB0ID0gKHB6IC0gcHYwLnopIC8gKHB2MS56IC0gcHYwLnopO1xyXG4gICAgICAgIGxldCB4ID0gbGVycChwdjAueCwgcHYxLngsIHQpO1xyXG4gICAgICAgIGxldCB5ID0gbGVycChwdjAueSwgcHYxLnksIHQpO1xyXG5cclxuICAgICAgICAvLyB1duS5n+imgeaPkuWAvFxyXG4gICAgICAgIGxldCB1djAgPSB2MC51djtcclxuICAgICAgICBsZXQgdXYxID0gdjEudXY7XHJcbiAgICAgICAgbGV0IHUgPSBsZXJwKHV2MC54LCB1djEueCwgdCk7XHJcbiAgICAgICAgbGV0IHYgPSBsZXJwKHV2MC55LCB1djEueSwgdCk7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXcgVmVydGV4KHgsIHksIHB6LCB1LCB2KTtcclxuICAgIH1cclxuXHJcbiAgICAvL3B2byBpbiBcclxuICAgIGxldCBjbGlwX2ZpcnN0X2luID0gZnVuY3Rpb24gKHB2MDogVmVydGV4LCBwdjE6IFZlcnRleCwgcHYyOiBWZXJ0ZXgpIHtcclxuICAgICAgICAvLyAxIHRyaWFuZ2xlIDEgb25lIHRyaWFuZ2xlXHJcbiAgICAgICAgdl9jbGlwWzBdID0gcHYwO1xyXG4gICAgICAgIHZfY2xpcFsxXSA9IGdldENyb3NzUG9pbnQocHYwLCBwdjEsIG5lYXJQbGFuZVopO1xyXG4gICAgICAgIHZfY2xpcFsyXSA9IGdldENyb3NzUG9pbnQocHYwLCBwdjIsIG5lYXJQbGFuZVopO1xyXG4gICAgfVxyXG5cclxuICAgIC8vcHZvIG91dFxyXG4gICAgbGV0IGNsaXBfZmlyc3Rfb3V0ID0gZnVuY3Rpb24gKHB2MDogVmVydGV4LCBwdjE6IFZlcnRleCwgcHYyOiBWZXJ0ZXgpIHtcclxuXHJcbiAgICAgICAgLy8gMSB0cmlhbmdsZSB0byAyIHRyaWFuZ2xlXHJcbiAgICAgICAgbGV0IGNyb3NzMSA9IGdldENyb3NzUG9pbnQocHYyLCBwdjAsIG5lYXJQbGFuZVopO1xyXG4gICAgICAgIGxldCBjcm9zczIgPSBnZXRDcm9zc1BvaW50KHB2MCwgcHYxLCBuZWFyUGxhbmVaKTtcclxuXHJcbiAgICAgICAgdl9jbGlwWzBdID0gcHYyO1xyXG4gICAgICAgIHZfY2xpcFsxXSA9IGNyb3NzMTtcclxuICAgICAgICB2X2NsaXBbMl0gPSBjcm9zczI7XHJcblxyXG4gICAgICAgIHZfY2xpcFszXSA9IHB2Mi5jb3B5KCk7XHJcbiAgICAgICAgdl9jbGlwWzRdID0gY3Jvc3MyO1xyXG4gICAgICAgIHZfY2xpcFs1XSA9IHB2MTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8g5pyJOOeoruaDheazgVxyXG4gICAgaWYgKHRyaWFuZ2xlLnYwLnAueiA8IG5lYXJQbGFuZVopLy9vdXRcclxuICAgIHtcclxuICAgICAgICBpZiAodHJpYW5nbGUudjEucC56IDwgbmVhclBsYW5lWikgLy9vdXQgb3V0XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZiAodHJpYW5nbGUudjIucC56IDwgbmVhclBsYW5lWikvL2Z1bGwgb3V0IG9mIG5lYXJQbGFuZVogKG5vIGNsaXApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdmdWxsIG91dCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgLy9vdXQgb3V0IGluXHJcbiAgICAgICAgICAgICAgICBjbGlwX2ZpcnN0X2luKHRyaWFuZ2xlLnYyLCB0cmlhbmdsZS52MCwgdHJpYW5nbGUudjEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIC8vb3V0IGluIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYgKHRyaWFuZ2xlLnYyLnAueiA8IG5lYXJQbGFuZVopLy9vdXQgaW4gb3V0XHJcbiAgICAgICAgICAgICAgICBjbGlwX2ZpcnN0X2luKHRyaWFuZ2xlLnYxLCB0cmlhbmdsZS52MiwgdHJpYW5nbGUudjApO1xyXG4gICAgICAgICAgICBlbHNlIC8vIG91dCBpbiBpblxyXG4gICAgICAgICAgICAgICAgY2xpcF9maXJzdF9vdXQodHJpYW5nbGUudjAsIHRyaWFuZ2xlLnYxLCB0cmlhbmdsZS52Mik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSAvLyBpblxyXG4gICAge1xyXG4gICAgICAgIGlmICh0cmlhbmdsZS52MS5wLnogPCBuZWFyUGxhbmVaKS8vIGluIG91dCBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmICh0cmlhbmdsZS52Mi5wLnogPCBuZWFyUGxhbmVaKS8vIGluIG91dCBvdXRcclxuICAgICAgICAgICAgICAgIGNsaXBfZmlyc3RfaW4odHJpYW5nbGUudjAsIHRyaWFuZ2xlLnYxLCB0cmlhbmdsZS52Mik7XHJcbiAgICAgICAgICAgIGVsc2UgLy8gaW4gb3V0IGluXHJcbiAgICAgICAgICAgICAgICBjbGlwX2ZpcnN0X291dCh0cmlhbmdsZS52MSwgdHJpYW5nbGUudjIsIHRyaWFuZ2xlLnYwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSAvLyBpbiBpblxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYgKHRyaWFuZ2xlLnYyLnAueiA8IG5lYXJQbGFuZVopLy8gaW4gaW4gb3V0XHJcbiAgICAgICAgICAgICAgICBjbGlwX2ZpcnN0X291dCh0cmlhbmdsZS52MiwgdHJpYW5nbGUudjAsIHRyaWFuZ2xlLnYxKTtcclxuICAgICAgICAgICAgZWxzZSAvLyBpbiBpbiBpbiAobm8gY2xpcClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdl9jbGlwWzBdID0gdHJpYW5nbGUudjA7XHJcbiAgICAgICAgICAgICAgICB2X2NsaXBbMV0gPSB0cmlhbmdsZS52MTtcclxuICAgICAgICAgICAgICAgIHZfY2xpcFsyXSA9IHRyaWFuZ2xlLnYyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB2X2NsaXA7XHJcbn0iLCJpbXBvcnQgeyBudW1iZXJfZXF1YWwgfSBmcm9tICcuL1Rvb2wnXHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmVjdG9yIHtcclxuXHJcbiAgICBzdGF0aWMgdXYodTogbnVtYmVyLCB2OiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFZlY3Rvcih1LCB2LCAwKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgdXAgPSBuZXcgVmVjdG9yKDAsIDEsIDApO1xyXG4gICAgc3RhdGljIHplcm8gPSBuZXcgVmVjdG9yKDAsIDAsIDApO1xyXG5cclxuICAgIHN0YXRpYyByZWZsZWN0KEk6IFZlY3RvciwgTjogVmVjdG9yKSB7XHJcbiAgICAgICAgbGV0IEwgPSAtMiAqIFZlY3Rvci5kb3QoSSwgTilcclxuICAgICAgICByZXR1cm4gTi5tdWx0aXBseShMKS5hZGQoSSk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGFkZChBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIGxldCB0ZW1wID0gbmV3IFZlY3RvcihCLnggKyBBLngsIEIueSArIEEueSwgQi56ICsgQS56KTtcclxuICAgICAgICByZXR1cm4gdGVtcFxyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBtaW51cyhBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIGxldCB0ZW1wID0gbmV3IFZlY3RvcihBLnggLSBCLngsIEEueSAtIEIueSwgQS56IC0gQi56KTtcclxuICAgICAgICByZXR1cm4gdGVtcFxyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBtdWx0aXBseShBOiBWZWN0b3IsIHM6IG51bWJlcikge1xyXG4gICAgICAgIGxldCB0ZW1wID0gbmV3IFZlY3RvcihBLnggKiBzLCBBLnkgKiBzLCBBLnogKiBzKTtcclxuICAgICAgICByZXR1cm4gdGVtcFxyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBtdWx0aXBseTMoQTogVmVjdG9yLCBCOiBWZWN0b3IpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcihBLnggKiBCLngsIEEueSAqIEIueSwgQS56ICogQi56KTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgY3Jvc3MoQTogVmVjdG9yLCBCOiBWZWN0b3IpIHtcclxuICAgICAgICBsZXQgdGVtcCA9IG5ldyBWZWN0b3IoQS55ICogQi56IC0gQS56ICogQi55LCAtQS54ICogQi56ICsgQS56ICogQi54LCBBLnggKiBCLnkgLSBBLnkgKiBCLngpO1xyXG4gICAgICAgIHJldHVybiB0ZW1wO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBkb3QoQTogVmVjdG9yLCBCOiBWZWN0b3IpIHtcclxuICAgICAgICByZXR1cm4gQS54ICogQi54ICsgQS55ICogQi55ICsgQS56ICogQi56O1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBlcXVhbChBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIHJldHVybiBudW1iZXJfZXF1YWwoQS54LCBCLngpICYmIG51bWJlcl9lcXVhbChBLnksIEIueSkgJiYgbnVtYmVyX2VxdWFsKEEueiwgQi56KTtcclxuICAgIH1cclxuXHJcbiAgICB4OiBudW1iZXIgPSAwO1xyXG4gICAgeTogbnVtYmVyID0gMDtcclxuICAgIHo6IG51bWJlciA9IDA7XHJcbiAgICBjb25zdHJ1Y3RvcihweDogbnVtYmVyLCBweTogbnVtYmVyLCBwejogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy54ID0gcHg7XHJcbiAgICAgICAgdGhpcy55ID0gcHk7XHJcbiAgICAgICAgdGhpcy56ID0gcHo7XHJcbiAgICB9XHJcblxyXG4gICAgbGVuZ3RoKCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56KTtcclxuICAgIH1cclxuXHJcbiAgICBub3JtYWxpemUoKSB7XHJcbiAgICAgICAgbGV0IHRlbXAgPSB0aGlzLmxlbmd0aCgpO1xyXG4gICAgICAgIHRoaXMueCA9IHRoaXMueCAvIHRlbXA7XHJcbiAgICAgICAgdGhpcy55ID0gdGhpcy55IC8gdGVtcDtcclxuICAgICAgICB0aGlzLnogPSB0aGlzLnogLyB0ZW1wO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZChBOiBWZWN0b3IpIHtcclxuICAgICAgICByZXR1cm4gVmVjdG9yLmFkZCh0aGlzLCBBKTtcclxuICAgIH1cclxuXHJcbiAgICBtaW51cyhBOiBWZWN0b3IpIHtcclxuICAgICAgICByZXR1cm4gVmVjdG9yLm1pbnVzKHRoaXMsIEEpO1xyXG4gICAgfVxyXG5cclxuICAgIG11bHRpcGx5KHM6IG51bWJlcikge1xyXG4gICAgICAgIHJldHVybiBWZWN0b3IubXVsdGlwbHkodGhpcywgcyk7XHJcbiAgICB9XHJcblxyXG4gICAgbmVnYXRpdmUoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5tdWx0aXBseSh0aGlzLCAtMSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvbmUoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IodGhpcy54LCB0aGlzLnksIHRoaXMueik7XHJcbiAgICB9XHJcbn0iLCJcclxuaW1wb3J0IFZlY3RvciBmcm9tICcuL1ZlY3RvcidcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZlcnRleCB7XHJcbiAgICBzdGF0aWMgYnVpbGRfdmVydGV4KHA6IFZlY3RvciwgdXY6IFZlY3Rvcikge1xyXG4gICAgICAgIGxldCB2ZXJ0ZXggPSBuZXcgVmVydGV4KHAueCwgcC55LCBwLnosIHV2LngsIHV2LnkpO1xyXG4gICAgICAgIHJldHVybiB2ZXJ0ZXg7XHJcbiAgICB9XHJcblxyXG4gICAgcDogVmVjdG9yO1xyXG4gICAgdXY6IFZlY3RvcjtcclxuICAgIGNvbnN0cnVjdG9yKHg6IG51bWJlciwgeTogbnVtYmVyLCB6OiBudW1iZXIsIHU6IG51bWJlciwgdjogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5wID0gbmV3IFZlY3Rvcih4LCB5LCB6KTtcclxuICAgICAgICB0aGlzLnV2ID0gbmV3IFZlY3Rvcih1LCB2LCAwKTtcclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNvcHkoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlcnRleC5idWlsZF92ZXJ0ZXgodGhpcy5wLCB0aGlzLnV2KTtcclxuICAgIH1cclxufSIsImltcG9ydCBWZWN0b3IgZnJvbSBcIi4vVmVjdG9yXCI7XHJcbmltcG9ydCB7IGRlZ3JlZV90b19SYWQgfSBmcm9tICcuL1Rvb2wnXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUcmFuc2Zvcm0ge1xyXG4gICAgeEF4aXM6IFZlY3RvcjtcclxuICAgIHlBeGlzOiBWZWN0b3I7XHJcbiAgICB6QXhpczogVmVjdG9yO1xyXG4gICAgcG9zaXRpb246IFZlY3RvcjtcclxuICAgIGNvbnN0cnVjdG9yKHhBeGlzOiBWZWN0b3IsIHlBeGlzOiBWZWN0b3IsIHpBeGlzOiBWZWN0b3IsIHBvc2l0aW9uOiBWZWN0b3IpIHtcclxuICAgICAgICB0aGlzLnhBeGlzID0geEF4aXM7XHJcbiAgICAgICAgdGhpcy55QXhpcyA9IHlBeGlzO1xyXG4gICAgICAgIHRoaXMuekF4aXMgPSB6QXhpcztcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIHRyYW5zZm9ybVBvaW50KHRyYW5zZm9ybTogVHJhbnNmb3JtLCBwb2ludDogVmVjdG9yKSB7XHJcbiAgICAgICAgbGV0IHZlY3RvclggPSB0cmFuc2Zvcm0ueEF4aXMubXVsdGlwbHkocG9pbnQueCk7XHJcbiAgICAgICAgbGV0IHZlY3RvclkgPSB0cmFuc2Zvcm0ueUF4aXMubXVsdGlwbHkocG9pbnQueSk7XHJcbiAgICAgICAgbGV0IHZlY3RvclogPSB0cmFuc2Zvcm0uekF4aXMubXVsdGlwbHkocG9pbnQueik7XHJcblxyXG4gICAgICAgIHJldHVybiB0cmFuc2Zvcm0ucG9zaXRpb24uYWRkKHZlY3RvclgpLmFkZCh2ZWN0b3JZKS5hZGQodmVjdG9yWik7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIHRyYW5zZm9ybVZlY3Rvcih0cmFuc2Zvcm06IFRyYW5zZm9ybSwgdmVydGV4OiBWZWN0b3IpIHtcclxuICAgICAgICBsZXQgdmVjdG9yWCA9IHRyYW5zZm9ybS54QXhpcy5tdWx0aXBseSh2ZXJ0ZXgueCk7XHJcbiAgICAgICAgbGV0IHZlY3RvclkgPSB0cmFuc2Zvcm0ueUF4aXMubXVsdGlwbHkodmVydGV4LnkpO1xyXG4gICAgICAgIGxldCB2ZWN0b3JaID0gdHJhbnNmb3JtLnpBeGlzLm11bHRpcGx5KHZlcnRleC56KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHZlY3RvclguYWRkKHZlY3RvclkpLmFkZCh2ZWN0b3JaKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgdHJhbnNmb3JtVHJhbnNmb3JtKHRyYW5zZm9ybTogVHJhbnNmb3JtLCBpbnB1dFRyYW5zZm9ybTogVHJhbnNmb3JtKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2Zvcm0oXHJcbiAgICAgICAgICAgIFRyYW5zZm9ybS50cmFuc2Zvcm1WZWN0b3IodHJhbnNmb3JtLCBpbnB1dFRyYW5zZm9ybS54QXhpcyksXHJcbiAgICAgICAgICAgIFRyYW5zZm9ybS50cmFuc2Zvcm1WZWN0b3IodHJhbnNmb3JtLCBpbnB1dFRyYW5zZm9ybS55QXhpcyksXHJcbiAgICAgICAgICAgIFRyYW5zZm9ybS50cmFuc2Zvcm1WZWN0b3IodHJhbnNmb3JtLCBpbnB1dFRyYW5zZm9ybS56QXhpcyksXHJcbiAgICAgICAgICAgIFRyYW5zZm9ybS50cmFuc2Zvcm1Qb2ludCh0cmFuc2Zvcm0sIGlucHV0VHJhbnNmb3JtLnBvc2l0aW9uKSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyByb3RhdGVCeVooZGVncmVlOiBudW1iZXIpIHtcclxuICAgICAgICBsZXQgcmFkaWFuID0gZGVncmVlX3RvX1JhZChkZWdyZWUpO1xyXG4gICAgICAgIGxldCBjID0gTWF0aC5jb3MocmFkaWFuKSwgcyA9IE1hdGguc2luKHJhZGlhbik7XHJcbiAgICAgICAgbGV0IHhBeGlzID0gbmV3IFZlY3RvcihjLCBzLCAwKTtcclxuICAgICAgICBsZXQgeUF4aXMgPSBuZXcgVmVjdG9yKC1zLCBjLCAwKTtcclxuICAgICAgICBsZXQgekF4aXMgPSBuZXcgVmVjdG9yKDAsIDAsIDEpO1xyXG5cclxuICAgICAgICByZXR1cm4gbmV3IFRyYW5zZm9ybShcclxuICAgICAgICAgICAgeEF4aXMsXHJcbiAgICAgICAgICAgIHlBeGlzLFxyXG4gICAgICAgICAgICB6QXhpcyxcclxuICAgICAgICAgICAgVmVjdG9yLnplcm8sXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgcm90YXRlQnlYKGRlZ3JlZTogbnVtYmVyKSB7XHJcbiAgICAgICAgbGV0IHJhZGlhbiA9IGRlZ3JlZV90b19SYWQoZGVncmVlKTtcclxuICAgICAgICBsZXQgYyA9IE1hdGguY29zKHJhZGlhbiksIHMgPSBNYXRoLnNpbihyYWRpYW4pO1xyXG4gICAgICAgIGxldCB4QXhpcyA9IG5ldyBWZWN0b3IoMSwgMCwgMCk7XHJcbiAgICAgICAgbGV0IHlBeGlzID0gbmV3IFZlY3RvcigwLCBjLCBzKTtcclxuICAgICAgICBsZXQgekF4aXMgPSBuZXcgVmVjdG9yKDAsIC1zLCBjKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2Zvcm0oXHJcbiAgICAgICAgICAgIHhBeGlzLFxyXG4gICAgICAgICAgICB5QXhpcyxcclxuICAgICAgICAgICAgekF4aXMsXHJcbiAgICAgICAgICAgIG5ldyBWZWN0b3IoMCwgMCwgMCksXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgb2Zmc2V0KHg6IG51bWJlciwgeTogbnVtYmVyLCB6OiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFRyYW5zZm9ybShcclxuICAgICAgICAgICAgbmV3IFZlY3RvcigxLCAwLCAwKSxcclxuICAgICAgICAgICAgbmV3IFZlY3RvcigwLCAxLCAwKSxcclxuICAgICAgICAgICAgbmV3IFZlY3RvcigwLCAwLCAxKSxcclxuICAgICAgICAgICAgbmV3IFZlY3Rvcih4LCB5LCB6KSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuXHJcblxyXG4iLCJpbXBvcnQgVHJhbnNmb3JtIGZyb20gJy4vVHJhbnNmb3JtJztcclxuaW1wb3J0IFZlY3RvciBmcm9tICcuL1ZlY3RvcidcclxuaW1wb3J0IFZlcnRleCBmcm9tICcuL1ZlcnRleCdcclxuaW1wb3J0IHsgY2xpcCB9IGZyb20gJy4vVG9vbCc7XHJcbmltcG9ydCBDYW1lcmEgZnJvbSAnLi9DYW1lcmEnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVHJpYW5nbGUge1xyXG5cclxuICAgIHN0YXRpYyBwcm9jZXNzKHRyaWFuZ2xlOiBUcmlhbmdsZSwgcGNhbWVyYTogQ2FtZXJhLCB3b3JsZFRyYW5zZm9ybTogVHJhbnNmb3JtKSB7XHJcblxyXG4gICAgICAgIC8vIHRvIHdvcmxkIHNwYWNlXHJcbiAgICAgICAgbGV0IHYwX3cgPSBUcmFuc2Zvcm0udHJhbnNmb3JtUG9pbnQod29ybGRUcmFuc2Zvcm0sIHRyaWFuZ2xlLnYwLnApO1xyXG4gICAgICAgIGxldCB2MV93ID0gVHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50KHdvcmxkVHJhbnNmb3JtLCB0cmlhbmdsZS52MS5wKTtcclxuICAgICAgICBsZXQgdjJfdyA9IFRyYW5zZm9ybS50cmFuc2Zvcm1Qb2ludCh3b3JsZFRyYW5zZm9ybSwgdHJpYW5nbGUudjIucCk7XHJcblxyXG4gICAgICAgIC8vIHRvIGNhbWVyYSBzcGFjZVxyXG4gICAgICAgIGxldCB2MF9jID0gcGNhbWVyYS50b0NhbWVyYVNwYWNlKHYwX3cpO1xyXG4gICAgICAgIGxldCB2MV9jID0gcGNhbWVyYS50b0NhbWVyYVNwYWNlKHYxX3cpO1xyXG4gICAgICAgIGxldCB2Ml9jID0gcGNhbWVyYS50b0NhbWVyYVNwYWNlKHYyX3cpO1xyXG5cclxuICAgICAgICAvL2JhY2sgZmFjZSBjdWxsaW5nXHJcbiAgICAgICAgbGV0IHYwMSA9IFZlY3Rvci5taW51cyh2MV9jLCB2MF9jKTtcclxuICAgICAgICBsZXQgdjAyID0gVmVjdG9yLm1pbnVzKHYyX2MsIHYwX2MpO1xyXG4gICAgICAgIGxldCBub3JtYWwgPSBWZWN0b3IuY3Jvc3ModjAyLCB2MDEpO1xyXG4gICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTtcclxuXHJcbiAgICAgICAgbGV0IGNlbnRlciA9IHYwX2MuYWRkKHYxX2MpLmFkZCh2Ml9jKS5tdWx0aXBseSgxIC8gMyk7XHJcbiAgICAgICAgbGV0IGNlbnRlcl90b19leWUgPSBWZWN0b3IubWludXMoVmVjdG9yLnplcm8sIGNlbnRlcik7XHJcbiAgICAgICAgY2VudGVyX3RvX2V5ZS5ub3JtYWxpemUoKTtcclxuICAgICAgICBsZXQgY29zX3ZhbHVlID0gVmVjdG9yLmRvdChub3JtYWwsIGNlbnRlcl90b19leWUpOztcclxuICAgICAgICBpZiAoY29zX3ZhbHVlIDw9IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDph43mlrDntoHlrpp1dlxyXG4gICAgICAgIGxldCB2MF9jX3V2ID0gVmVydGV4LmJ1aWxkX3ZlcnRleCh2MF9jLCB0cmlhbmdsZS52MC51dik7XHJcbiAgICAgICAgbGV0IHYxX2NfdXYgPSBWZXJ0ZXguYnVpbGRfdmVydGV4KHYxX2MsIHRyaWFuZ2xlLnYxLnV2KTtcclxuICAgICAgICBsZXQgdjJfY191diA9IFZlcnRleC5idWlsZF92ZXJ0ZXgodjJfYywgdHJpYW5nbGUudjIudXYpO1xyXG5cclxuICAgICAgICAvL2RvIG9ubHkgbmVhclBsYW5lIGNsaXBcclxuICAgICAgICBsZXQgbmVhclBsYW5lWiA9IDE7XHJcbiAgICAgICAgbGV0IHZfY2xpcCA9IGNsaXAobmV3IFRyaWFuZ2xlKHYwX2NfdXYsIHYxX2NfdXYsIHYyX2NfdXYpLCBuZWFyUGxhbmVaKTtcclxuXHJcbiAgICAgICAgLy8gdG8gc2NyZWVuIHNwYWNlXHJcbiAgICAgICAgbGV0IHZfczogVmVjdG9yW10gPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZfY2xpcC5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB2X3NbaV0gPSBwY2FtZXJhLnRvU2NyZWVuU3BhY2Uodl9jbGlwW2ldLnApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdl9zO1xyXG4gICAgfVxyXG5cclxuICAgIHYwOiBWZXJ0ZXg7XHJcbiAgICB2MTogVmVydGV4O1xyXG4gICAgdjI6IFZlcnRleDtcclxuICAgIGNvbnN0cnVjdG9yKHB2MDogVmVydGV4LCBwdjE6IFZlcnRleCwgcHYyOiBWZXJ0ZXgpIHtcclxuICAgICAgICB0aGlzLnYwID0gcHYwO1xyXG4gICAgICAgIHRoaXMudjEgPSBwdjE7XHJcbiAgICAgICAgdGhpcy52MiA9IHB2MjtcclxuICAgIH1cclxuXHJcbiAgICB2X3M6IFZlY3RvcltdO1xyXG4gICAgcHJvY2VzcyhwY2FtZXJhOiBDYW1lcmEsIHdvcmxkVHJhbnNmb3JtOiBUcmFuc2Zvcm0pIHtcclxuICAgICAgICB0aGlzLnZfcyA9IFRyaWFuZ2xlLnByb2Nlc3ModGhpcywgcGNhbWVyYSwgd29ybGRUcmFuc2Zvcm0pO1xyXG4gICAgfVxyXG5cclxuICAgIGRyYXcoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpIHtcclxuICAgICAgICBpZiAodGhpcy52X3MgPT0gbnVsbClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQgdENvdW50ID0gdGhpcy52X3MubGVuZ3RoIC8gMztcclxuICAgICAgICBmb3IgKGxldCBjID0gMTsgYyA8PSB0Q291bnQ7ICsrYykge1xyXG4gICAgICAgICAgICBsZXQgaW5kZXggPSAzICogYyAtIDE7XHJcbiAgICAgICAgICAgIGN0eC5tb3ZlVG8odGhpcy52X3NbaW5kZXhdLngsIHRoaXMudl9zW2luZGV4XS55KTtcclxuICAgICAgICAgICAgY3R4LmxpbmVUbyh0aGlzLnZfc1tpbmRleCAtIDJdLngsIHRoaXMudl9zW2luZGV4IC0gMl0ueSk7XHJcbiAgICAgICAgICAgIGN0eC5saW5lVG8odGhpcy52X3NbaW5kZXggLSAxXS54LCB0aGlzLnZfc1tpbmRleCAtIDFdLnkpO1xyXG4gICAgICAgICAgICBjdHgubGluZVRvKHRoaXMudl9zW2luZGV4XS54LCB0aGlzLnZfc1tpbmRleF0ueSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4iLCJpbXBvcnQgVmVydGV4IGZyb20gJy4vVmVydGV4J1xyXG5pbXBvcnQgVHJpYW5nbGUgZnJvbSAnLi9UcmlhbmdsZSc7XHJcbmltcG9ydCBWZWN0b3IgZnJvbSAnLi9WZWN0b3InO1xyXG5pbXBvcnQgVHJhbnNmb3JtIGZyb20gJy4vVHJhbnNmb3JtJztcclxuaW1wb3J0IHsgY2xpcCB9IGZyb20gJy4vVG9vbCc7XHJcbmltcG9ydCBDYW1lcmEgZnJvbSAnLi9DYW1lcmEnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQm94IHtcclxuICAgIHRyaWFuZ2xlczogVHJpYW5nbGVbXTtcclxuICAgIHRyaWFuZ2xlc19hZnRlcl9jbGlwOiBUcmlhbmdsZVtdO1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgLy8g5bu656uL5q2j5pa56auU6aCC6bue6LOH5paZXHJcbiAgICAgICAgdGhpcy50cmlhbmdsZXMgPSBbXTtcclxuICAgICAgICAvL+mghuaZgumHnVxyXG4gICAgICAgIHRoaXMudHJpYW5nbGVzLnB1c2goXHJcbiAgICAgICAgICAgIG5ldyBUcmlhbmdsZShcclxuICAgICAgICAgICAgICAgIFZlcnRleC5idWlsZF92ZXJ0ZXgobmV3IFZlY3RvcigtMTAsIC0xMCwgLTEwKSwgVmVjdG9yLnV2KDAsIDApKSxcclxuICAgICAgICAgICAgICAgIFZlcnRleC5idWlsZF92ZXJ0ZXgobmV3IFZlY3RvcigxMCwgLTEwLCAxMCksIFZlY3Rvci51digxLCAxKSksXHJcbiAgICAgICAgICAgICAgICBWZXJ0ZXguYnVpbGRfdmVydGV4KG5ldyBWZWN0b3IoMTAsIC0xMCwgLTEwKSwgVmVjdG9yLnV2KDEsIDApKVxyXG4gICAgICAgICAgICApKTtcclxuICAgICAgICB0aGlzLnRyaWFuZ2xlcy5wdXNoKFxyXG4gICAgICAgICAgICBuZXcgVHJpYW5nbGUoXHJcbiAgICAgICAgICAgICAgICBWZXJ0ZXguYnVpbGRfdmVydGV4KG5ldyBWZWN0b3IoLTEwLCAtMTAsIC0xMCksIFZlY3Rvci51digwLCAwKSksXHJcbiAgICAgICAgICAgICAgICBWZXJ0ZXguYnVpbGRfdmVydGV4KG5ldyBWZWN0b3IoLTEwLCAtMTAsIDEwKSwgVmVjdG9yLnV2KDAsIDEpKSxcclxuICAgICAgICAgICAgICAgIFZlcnRleC5idWlsZF92ZXJ0ZXgobmV3IFZlY3RvcigxMCwgLTEwLCAxMCksIFZlY3Rvci51digxLCAxKSlcclxuICAgICAgICAgICAgKSk7XHJcblxyXG4gICAgICAgIGxldCBtID0gW1RyYW5zZm9ybS5yb3RhdGVCeVooOTApLCBUcmFuc2Zvcm0ucm90YXRlQnlaKDE4MCksIFRyYW5zZm9ybS5yb3RhdGVCeVooMjcwKSwgVHJhbnNmb3JtLnJvdGF0ZUJ5WCg5MCksIFRyYW5zZm9ybS5yb3RhdGVCeVgoLTkwKV1cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG0ubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgbGV0IHJvdGF0ZU1hdHJpeCA9IG1baV1cclxuICAgICAgICAgICAgdGhpcy50cmlhbmdsZXMucHVzaChcclxuICAgICAgICAgICAgICAgIG5ldyBUcmlhbmdsZShcclxuICAgICAgICAgICAgICAgICAgICBWZXJ0ZXguYnVpbGRfdmVydGV4KFRyYW5zZm9ybS50cmFuc2Zvcm1Qb2ludChyb3RhdGVNYXRyaXgsIG5ldyBWZWN0b3IoLTEwLCAtMTAsIC0xMCkpLCBWZWN0b3IudXYoMCwgMCkpLFxyXG4gICAgICAgICAgICAgICAgICAgIFZlcnRleC5idWlsZF92ZXJ0ZXgoVHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50KHJvdGF0ZU1hdHJpeCwgbmV3IFZlY3RvcigxMCwgLTEwLCAxMCkpLCBWZWN0b3IudXYoMSwgMSkpLFxyXG4gICAgICAgICAgICAgICAgICAgIFZlcnRleC5idWlsZF92ZXJ0ZXgoVHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50KHJvdGF0ZU1hdHJpeCwgbmV3IFZlY3RvcigxMCwgLTEwLCAtMTApKSwgVmVjdG9yLnV2KDEsIDApKVxyXG4gICAgICAgICAgICAgICAgKSk7XHJcbiAgICAgICAgICAgIHRoaXMudHJpYW5nbGVzLnB1c2goXHJcbiAgICAgICAgICAgICAgICBuZXcgVHJpYW5nbGUoXHJcbiAgICAgICAgICAgICAgICAgICAgVmVydGV4LmJ1aWxkX3ZlcnRleChUcmFuc2Zvcm0udHJhbnNmb3JtUG9pbnQocm90YXRlTWF0cml4LCBuZXcgVmVjdG9yKC0xMCwgLTEwLCAtMTApKSwgVmVjdG9yLnV2KDAsIDApKSxcclxuICAgICAgICAgICAgICAgICAgICBWZXJ0ZXguYnVpbGRfdmVydGV4KFRyYW5zZm9ybS50cmFuc2Zvcm1Qb2ludChyb3RhdGVNYXRyaXgsIG5ldyBWZWN0b3IoLTEwLCAtMTAsIDEwKSksIFZlY3Rvci51digwLCAxKSksXHJcbiAgICAgICAgICAgICAgICAgICAgVmVydGV4LmJ1aWxkX3ZlcnRleChUcmFuc2Zvcm0udHJhbnNmb3JtUG9pbnQocm90YXRlTWF0cml4LCBuZXcgVmVjdG9yKDEwLCAtMTAsIDEwKSksIFZlY3Rvci51digxLCAxKSlcclxuICAgICAgICAgICAgICAgICkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUoY2FtZXJhOiBDYW1lcmEsIHdvcmxkVHJhbnNmb3JtOiBUcmFuc2Zvcm0pIHtcclxuXHJcbiAgICAgICAgdGhpcy50cmlhbmdsZXNfYWZ0ZXJfY2xpcCA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmlhbmdsZXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgbGV0IHRyaWFuZ2xlID0gdGhpcy50cmlhbmdsZXNbaV07XHJcbiAgICAgICAgICAgIGxldCBuZWFyUGxhbmVaID0gLTE7XHJcbiAgICAgICAgICAgIGxldCB2X2NsaXAgPSBjbGlwKHRyaWFuZ2xlLCBuZWFyUGxhbmVaKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjb3VudCA9IHZfY2xpcC5sZW5ndGggLyAzO1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpLCBjb3VudCk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgY291bnQ7ICsraykge1xyXG4gICAgICAgICAgICAgICAgLy8g57WE5ZCI5LiJ6KeS5b2iXHJcbiAgICAgICAgICAgICAgICBsZXQgbmV3X3RyaWFuZ2xlID0gbmV3IFRyaWFuZ2xlKHZfY2xpcFtrICogM10sIHZfY2xpcFtrICogMyArIDFdLCB2X2NsaXBbayAqIDMgKyAyXSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWFuZ2xlc19hZnRlcl9jbGlwLnB1c2gobmV3X3RyaWFuZ2xlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRyaWFuZ2xlc19hZnRlcl9jbGlwID0gdGhpcy50cmlhbmdsZXM7XHJcblxyXG4gICAgICAgIC8vIOiZleeQhuato+aWuemrlOeahOiuiuaPm1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmlhbmdsZXNfYWZ0ZXJfY2xpcC5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB0aGlzLnRyaWFuZ2xlc19hZnRlcl9jbGlwW2ldLnByb2Nlc3MoY2FtZXJhLCB3b3JsZFRyYW5zZm9ybSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGRyYXcoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpIHtcclxuICAgICAgICAvLyDnlavkuInop5LlvaJcclxuICAgICAgICBjdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ2Rlc3RpbmF0aW9uLW92ZXInO1xyXG5cclxuICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSAncmdiYSgyNTUsMCwwLDEpJztcclxuXHJcblxyXG4gICAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRyaWFuZ2xlc19hZnRlcl9jbGlwLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHRoaXMudHJpYW5nbGVzX2FmdGVyX2NsaXBbaV0uZHJhdyhjdHgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguc3Ryb2tlKCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgVmVjdG9yIGZyb20gXCIuLi9NYXRoL1ZlY3RvclwiO1xyXG5pbXBvcnQgSGl0SW5mbyBmcm9tIFwiLi4vTWF0aC9IaXRJbmZvXCI7XHJcbmltcG9ydCB7IGNsYW1wLCBnZXRfc2hhZG93X3dlaWdodCB9IGZyb20gXCIuLi9NYXRoL1Rvb2xcIjtcclxuaW1wb3J0IFNoYWRlciBmcm9tIFwiLi9TaGFkZXJcIjtcclxuaW1wb3J0IFNjZW5lTm9kZSBmcm9tIFwiLi4vT2JqZWN0L1NjZW5lTm9kZVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGlmZnVzZSBpbXBsZW1lbnRzIFNoYWRlciB7XHJcbiAgICBzdGF0aWMgeWVsbG93ID0gbmV3IERpZmZ1c2UobmV3IFZlY3RvcigxLCAxLCAwKSk7XHJcbiAgICBzdGF0aWMgcmVkID0gbmV3IERpZmZ1c2UobmV3IFZlY3RvcigxLCAwLCAwKSk7XHJcbiAgICBzdGF0aWMgZ3JlZW4gPSBuZXcgRGlmZnVzZShuZXcgVmVjdG9yKDAsIDEsIDApKTtcclxuICAgIHN0YXRpYyBibHVlID0gbmV3IERpZmZ1c2UobmV3IFZlY3RvcigwLCAwLCAxKSk7XHJcbiAgICBzdGF0aWMgZ3JheSA9IG5ldyBEaWZmdXNlKG5ldyBWZWN0b3IoMC41LCAwLjUsIDAuNSkpO1xyXG4gICAgc3RhdGljIHdoaXRlID0gbmV3IERpZmZ1c2UobmV3IFZlY3RvcigxLCAxLCAxKSk7XHJcblxyXG4gICAgY29sb3I6IFZlY3RvcjtcclxuICAgIGNvbnN0cnVjdG9yKGNvbG9yOiBWZWN0b3IpIHtcclxuICAgICAgICB0aGlzLmNvbG9yID0gY29sb3I7XHJcbiAgICB9XHJcblxyXG4gICAgc2hhZGluZyhoaXRfaW5mbzogSGl0SW5mbywgZGlyZWN0aW9uX2xpZ2h0X2RpcjogVmVjdG9yLCBvYmpfbGlzdDogU2NlbmVOb2RlW10sIGRlcHRoOiBudW1iZXIpIHtcclxuICAgICAgICBsZXQgbiA9IGhpdF9pbmZvLm5vcm1hbDtcclxuICAgICAgICBsZXQgc3RyZW5ndGggPSBjbGFtcCgtVmVjdG9yLmRvdChkaXJlY3Rpb25fbGlnaHRfZGlyLCBuKSwgMCwgMSk7XHJcblxyXG4gICAgICAgIGxldCBzaGFkb3dfd2VpZ2h0ID0gZ2V0X3NoYWRvd193ZWlnaHQoaGl0X2luZm8sIGRpcmVjdGlvbl9saWdodF9kaXIsIG9ial9saXN0KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb2xvci5tdWx0aXBseShzdHJlbmd0aCkubXVsdGlwbHkoc2hhZG93X3dlaWdodCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgVmVjdG9yIGZyb20gXCIuL1ZlY3RvclwiO1xyXG5pbXBvcnQgUmF5IGZyb20gXCIuL1JheVwiO1xyXG5pbXBvcnQgeyBkZWdyZWVfdG9fUmFkLCBnZXRfaGl0X3NvcnRfbGlzdCB9IGZyb20gXCIuL1Rvb2xcIlxyXG5pbXBvcnQgUmVuZGVyVGFyZ2V0IGZyb20gXCIuL1JlbmRlclRhcmdldFwiO1xyXG5pbXBvcnQgSGl0SW5mbyBmcm9tIFwiLi9IaXRJbmZvXCI7XHJcbmltcG9ydCBTY2VuZU5vZGUgZnJvbSBcIi4uL09iamVjdC9TY2VuZU5vZGVcIjtcclxuaW1wb3J0IERpZmZ1c2UgZnJvbSBcIi4uL01hdGVyYWlscy9EaWZmdXNlXCI7XHJcbmltcG9ydCBWZXJ0ZXggZnJvbSBcIi4vVmVydGV4XCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYW1lcmEge1xyXG4gICAgZXllOiBWZWN0b3I7XHJcblxyXG4gICAgeF9heGlzOiBWZWN0b3I7XHJcbiAgICB5X2F4aXM6IFZlY3RvcjtcclxuICAgIHpfYXhpczogVmVjdG9yO1xyXG5cclxuICAgIHJhdGlvOiBudW1iZXI7XHJcblxyXG4gICAgc2NyZWVuVzogbnVtYmVyO1xyXG4gICAgc2NyZWVuSDogbnVtYmVyO1xyXG5cclxuICAgIHNjcmVlbkNlbnRlclg6IG51bWJlcjtcclxuICAgIHNjcmVlbkNlbnRlclk6IG51bWJlcjtcclxuICAgIGhhbGZXOiBudW1iZXI7XHJcbiAgICBoYWxmSDogbnVtYmVyO1xyXG5cclxuICAgIGZvdl9kZWdyZWU6IG51bWJlcjtcclxuICAgIGNvbnN0cnVjdG9yKGV5ZTogVmVjdG9yLCBsb29rX2F0OiBWZWN0b3IsIGZvdl9kZWdyZWU6IG51bWJlciwgc2NyZWVuVzogbnVtYmVyLCBzY3JlZW5IOiBudW1iZXIpIHtcclxuXHJcbiAgICAgICAgdGhpcy5yYXRpbyA9IHNjcmVlblcgLyBzY3JlZW5IO1xyXG4gICAgICAgIHRoaXMuc2NyZWVuVyA9IHNjcmVlblc7XHJcbiAgICAgICAgdGhpcy5zY3JlZW5IID0gc2NyZWVuSDtcclxuICAgICAgICB0aGlzLnNjcmVlbkNlbnRlclggPSB0aGlzLnNjcmVlblcgKiAwLjU7XHJcbiAgICAgICAgdGhpcy5zY3JlZW5DZW50ZXJZID0gdGhpcy5zY3JlZW5IICogMC41O1xyXG4gICAgICAgIHRoaXMuaGFsZlcgPSB0aGlzLnNjcmVlblcgKiAwLjU7XHJcbiAgICAgICAgdGhpcy5oYWxmSCA9IHRoaXMuc2NyZWVuSCAqIDAuNTtcclxuXHJcbiAgICAgICAgLy8gY2FtZXJhIDPou7hcclxuICAgICAgICB0aGlzLnpfYXhpcyA9IFZlY3Rvci5taW51cyhsb29rX2F0LCBleWUpLm5vcm1hbGl6ZSgpO1xyXG5cclxuICAgICAgICAvLyDlt6bmiYtcclxuICAgICAgICBsZXQgaGVscF92ID0gVmVjdG9yLnVwO1xyXG4gICAgICAgIHRoaXMueF9heGlzID0gVmVjdG9yLmNyb3NzKGhlbHBfdiwgdGhpcy56X2F4aXMpLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgIHRoaXMueV9heGlzID0gVmVjdG9yLmNyb3NzKHRoaXMuel9heGlzLCB0aGlzLnhfYXhpcyk7XHJcblxyXG4gICAgICAgIC8vIGNhbWVyYSDljp/pu55cclxuICAgICAgICB0aGlzLmV5ZSA9IGV5ZTtcclxuXHJcbiAgICAgICAgLy8gY2FtZXJhIGZvdlxyXG4gICAgICAgIHRoaXMuZm92X2RlZ3JlZSA9IGZvdl9kZWdyZWU7XHJcbiAgICB9XHJcblxyXG4gICAgbW92ZUV5ZSA9IGZ1bmN0aW9uIChzOiBudW1iZXIsIEE6IFZlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuZXllID0gVmVjdG9yLmFkZCh0aGlzLmV5ZSwgQS5tdWx0aXBseShzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkUGl0Y2goZGVncmVlOiBudW1iZXIpIHtcclxuICAgICAgICAvLyB0b2RvOiDkuZjkuIpsb2NhbCBtYXRyaXhcclxuICAgIH1cclxuXHJcbiAgICBhZGRZYXcoZGVncmVlOiBudW1iZXIpIHtcclxuICAgICAgICAvLyB0b2RvOiDkuZjkuIpsb2NhbCBtYXRyaXhcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVfcmF5X2Rpcih4X3dlaWdodDogbnVtYmVyLCB5X3dlaWdodDogbnVtYmVyLCByYXRpbzogbnVtYmVyKSB7XHJcbiAgICAgICAgbGV0IGhhbGZfZm92X3JhZCA9IGRlZ3JlZV90b19SYWQoMC41ICogdGhpcy5mb3ZfZGVncmVlKTtcclxuICAgICAgICBsZXQgdGFuX2ggPSBNYXRoLnRhbihoYWxmX2Zvdl9yYWQpO1xyXG4gICAgICAgIGxldCB0YW5fdyA9IHRhbl9oICogcmF0aW87XHJcblxyXG4gICAgICAgIGxldCBkaXIgPSB0aGlzLnpfYXhpc1xyXG4gICAgICAgICAgICAuYWRkKHRoaXMueF9heGlzLm11bHRpcGx5KHhfd2VpZ2h0ICogdGFuX3cpKVxyXG4gICAgICAgICAgICAuYWRkKHRoaXMueV9heGlzLm11bHRpcGx5KHlfd2VpZ2h0ICogdGFuX2gpKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGRpcjtcclxuICAgIH1cclxuXHJcbiAgICB0b0NhbWVyYVNwYWNlKEE6IFZlY3Rvcikge1xyXG4gICAgICAgIGxldCBkaWZmID0gQS5taW51cyh0aGlzLmV5ZSk7XHJcbiAgICAgICAgbGV0IHBvaW50X2luX2NhbWVyYV9zcGFjZSA9IG5ldyBWZWN0b3IoVmVjdG9yLmRvdChkaWZmLCB0aGlzLnhfYXhpcyksIFZlY3Rvci5kb3QoZGlmZiwgdGhpcy55X2F4aXMpLCBWZWN0b3IuZG90KGRpZmYsIHRoaXMuel9heGlzKSk7XHJcbiAgICAgICAgcmV0dXJuIHBvaW50X2luX2NhbWVyYV9zcGFjZTtcclxuICAgIH1cclxuXHJcbiAgICB0b1NjcmVlblNwYWNlID0gZnVuY3Rpb24gKEE6IFZlY3Rvcikge1xyXG4gICAgICAgIGxldCB6ID0gLUEuejtcclxuICAgICAgICBsZXQgZm92X3JhZCA9IGRlZ3JlZV90b19SYWQodGhpcy5mb3ZfZGVncmVlKTtcclxuICAgICAgICBsZXQgaGFsZl9mb3YgPSAwLjUgKiBmb3ZfcmFkO1xyXG4gICAgICAgIGxldCB5X3NjYWxlID0gMSAvIE1hdGgudGFuKGhhbGZfZm92KTtcclxuICAgICAgICBsZXQgeF9zY2FsZSA9IDEgLyAodGhpcy5yYXRpbyAqIE1hdGgudGFuKGhhbGZfZm92KSk7XHJcblxyXG4gICAgICAgIGxldCBOREN4ID0gQS54ICogeF9zY2FsZSAvIHo7XHJcbiAgICAgICAgbGV0IE5EQ3kgPSBBLnkgKiB5X3NjYWxlIC8gejtcclxuXHJcbiAgICAgICAgLy8g55So5bqn5qiZ6K6K5o+b5L6G55yL5b6F5b6eTkRD5YiwU2NyZWVuIFNwYWNlXHJcbiAgICAgICAgLy8gTkRDIHjou7jlnKhzY3JlZW4gc3BhY2Ug54K6KHcvMiwwKVxyXG4gICAgICAgIC8vIE5EQyB56Lu45Zyoc2NyZWVuIHNwYWNlIOeCuigtaC8yLDApXHJcbiAgICAgICAgbGV0IHggPSB0aGlzLmhhbGZXICogTkRDeCArIHRoaXMuc2NyZWVuQ2VudGVyWDtcclxuICAgICAgICBsZXQgeSA9IC10aGlzLmhhbGZIICogTkRDeSArIHRoaXMuc2NyZWVuQ2VudGVyWTtcclxuXHJcbiAgICAgICAgbGV0IHRlbXAgPSBuZXcgVmVjdG9yKHgsIHksIHopO1xyXG4gICAgICAgIC8vYWxlcnQodGVtcC50b1N0cmluZygpKTtcclxuICAgICAgICByZXR1cm4gdGVtcDtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnrpflnJZcclxuICAgIHJlbmRlcihyZW5kZXJfdGFyZ2V0OiBSZW5kZXJUYXJnZXQsIG9ial9saXN0OiBTY2VuZU5vZGVbXSkge1xyXG4gICAgICAgIGxldCBkaXJlY3Rpb25fbGlnaHRfZGlyID0gbmV3IFZlY3RvcigxLCAtMSwgMCkubm9ybWFsaXplKCk7XHJcblxyXG4gICAgICAgIGxldCBoYWxmX3BpeGVsX29mZnNldCA9IDAuNSAvIHJlbmRlcl90YXJnZXQuaDtcclxuICAgICAgICBsZXQgbXVsdGlzYW1wbGVfZGlmZiA9IFtcclxuICAgICAgICAgICAgeyB4OiAwLCB5OiAwIH0sXHJcbiAgICAgICAgICAgIHsgeDogaGFsZl9waXhlbF9vZmZzZXQsIHk6IGhhbGZfcGl4ZWxfb2Zmc2V0IH0sXHJcbiAgICAgICAgICAgIHsgeDogLWhhbGZfcGl4ZWxfb2Zmc2V0LCB5OiBoYWxmX3BpeGVsX29mZnNldCB9LFxyXG4gICAgICAgICAgICB7IHg6IC1oYWxmX3BpeGVsX29mZnNldCwgeTogLWhhbGZfcGl4ZWxfb2Zmc2V0IH0sXHJcbiAgICAgICAgICAgIHsgeDogaGFsZl9waXhlbF9vZmZzZXQsIHk6IC1oYWxmX3BpeGVsX29mZnNldCB9LFxyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIHJlbmRlcl90YXJnZXQucmVuZGVyX3BpeGVsKCh4X3dlaWdodDogbnVtYmVyLCB5X3dlaWdodDogbnVtYmVyLCByYXRpbzogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCByYXlfZGlyID0gdGhpcy5jcmVhdGVfcmF5X2Rpcih4X3dlaWdodCwgeV93ZWlnaHQsIHJhdGlvKTtcclxuXHJcbiAgICAgICAgICAgIC8vIOeUoueUn+WkmuainXJheVxyXG4gICAgICAgICAgICBsZXQgcmF5cyA9IG11bHRpc2FtcGxlX2RpZmYubWFwKGRpZmYgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8g5bCNcmF5X2RyaeS9nOWBj+enu1xyXG4gICAgICAgICAgICAgICAgbGV0IGRpciA9IHJheV9kaXIuYWRkKHRoaXMueF9heGlzLm11bHRpcGx5KGRpZmYueCkpLmFkZCh0aGlzLnlfYXhpcy5tdWx0aXBseShkaWZmLnkpKVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIOmblueEtuWSjOeQg+OAgeW5s+mdoueahGhpdOioiOeul+S4jemcgOimgWRpcuS9nG5vcm1hbGl6Ze+8jOS9hueCuuS6huaWueS+v+WPjeWwhOeahOioiOeul+mChOaYr+S9nG5vcm1hbGl6ZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSYXkodGhpcy5leWUsIGRpci5ub3JtYWxpemUoKSlcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyDmr4/lgItyYXnpg73nrpdjb2xvclxyXG4gICAgICAgICAgICBsZXQgY29sb3JzID0gcmF5cy5tYXAocmF5ID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBoaXRfc29ydF9saXN0ID0gZ2V0X2hpdF9zb3J0X2xpc3Qob2JqX2xpc3QsIHJheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8g5pyJ5bCE5Lit5ZeOXHJcbiAgICAgICAgICAgICAgICBsZXQgaXNfaGl0ID0gaGl0X3NvcnRfbGlzdC5sZW5ndGggIT0gMDtcclxuICAgICAgICAgICAgICAgIGlmIChpc19oaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaGl0X2luZm8gPSBoaXRfc29ydF9saXN0WzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBoaXRfaW5mby5zLnNoYWRpbmcoaGl0X2luZm8sIGRpcmVjdGlvbl9saWdodF9kaXIsIG9ial9saXN0LCAxKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERpZmZ1c2UuZ3JheS5jb2xvcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyDlj5blubPlnYflsLHmnIlBbnRpYWxpYXNpbmfmlYjmnpxcclxuICAgICAgICAgICAgbGV0IGNvdW50ID0gbXVsdGlzYW1wbGVfZGlmZi5sZW5ndGg7XHJcbiAgICAgICAgICAgIGxldCBmaW5hbF9jb2xvciA9IGNvbG9ycy5yZWR1Y2UoKGFjY3VtdWxhdG9yOiBWZWN0b3IsIGN1cnJlbnQ6IFZlY3RvcikgPT4gYWNjdW11bGF0b3IuYWRkKGN1cnJlbnQpLCBWZWN0b3IuemVybykubXVsdGlwbHkoMSAvIGNvdW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbmFsX2NvbG9yO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn0iLCIvLyBpbXBvcnQgQXBwIGZyb20gJy4vQXBwJztcclxuLy8gbmV3IEFwcCgpO1xyXG5cclxuaW1wb3J0IFJhc3Rlcml6ZXJBcHAgZnJvbSAnLi9SYXN0ZXJpemVyQXBwJztcclxubmV3IFJhc3Rlcml6ZXJBcHAoKTsiLCJpbXBvcnQgQm94IGZyb20gXCIuL01hdGgvQm94M0RcIjtcclxuaW1wb3J0IENhbWVyYSBmcm9tIFwiLi9NYXRoL0NhbWVyYVwiO1xyXG5pbXBvcnQgVHJhbnNmb3JtIGZyb20gXCIuL01hdGgvVHJhbnNmb3JtXCI7XHJcbmltcG9ydCBWZWN0b3IgZnJvbSBcIi4vTWF0aC9WZWN0b3JcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJhc3Rlcml6ZXJBcHAge1xyXG5cclxuICAgIGNhbWVyYUluZGV4X3ZpZXcgPSAxO1xyXG4gICAgY2FtZXJhSW5kZXhfY29udHJvbCA9IDA7XHJcbiAgICBjYW1lcmE6IENhbWVyYSA9IG51bGw7XHJcbiAgICB0aGFuZGxlOiBudW1iZXI7XHJcblxyXG4gICAgc2NyZWVuV2lkdGggPSA4MDA7XHJcbiAgICBzY3JlZW5IZWlnaHQgPSA2MDA7XHJcbiAgICBib3g6IEJveCA9IG51bGw7XHJcblxyXG4gICAgbGFzdF90OiBudW1iZXI7XHJcbiAgICBzdW1fdDogbnVtYmVyO1xyXG4gICAgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcblxyXG4gICAgICAgIHdpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdCgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZG9jdW1lbnQub25rZXlkb3duID0gdGhpcy5rZXlQcm9jO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXQoKSB7XHJcbiAgICAgICAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcclxuICAgICAgICBjYW52YXMuc3R5bGUud2lkdGggPSB0aGlzLnNjcmVlbldpZHRoICsgJ3B4JztcclxuICAgICAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gdGhpcy5zY3JlZW5IZWlnaHQgKyAncHgnO1xyXG4gICAgICAgIGNhbnZhcy53aWR0aCA9IGNhbnZhcy5jbGllbnRXaWR0aDtcclxuICAgICAgICBjYW52YXMuaGVpZ2h0ID0gY2FudmFzLmNsaWVudEhlaWdodDtcclxuICAgICAgICB0aGlzLmN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuICAgICAgICB0aGlzLmJveCA9IG5ldyBCb3goKTtcclxuICAgICAgICB0aGlzLmNhbWVyYSA9IG5ldyBDYW1lcmEobmV3IFZlY3RvcigwLCAyNTAsIC0yMCksIG5ldyBWZWN0b3IoMCwgMCwgMCksIDYwLCB0aGlzLnNjcmVlbldpZHRoLCB0aGlzLnNjcmVlbkhlaWdodCk7XHJcbiAgICAgICAgdGhpcy5zdGFydCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG4gICAgICAgIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgIHRoaXMuc3VtX3QgPSAwO1xyXG4gICAgICAgIGxldCBkID0gbmV3IERhdGUoKTtcclxuICAgICAgICB0aGlzLmxhc3RfdCA9IGQuZ2V0VGltZSgpO1xyXG4gICAgICAgIHRoaXMudGhhbmRsZSA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7IHRoaXMuZHJhd1NjZW5lKCk7IH0sIDE2KTtcclxuICAgIH1cclxuXHJcbiAgICByZXN1bWUoKSB7XHJcbiAgICAgICAgbGV0IGQgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIHRoaXMubGFzdF90ID0gZC5nZXRUaW1lKCk7XHJcbiAgICAgICAgdGhpcy50aGFuZGxlID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHsgdGhpcy5kcmF3U2NlbmUoKTsgfSwgMTYpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0b3AoKSB7XHJcbiAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy50aGFuZGxlKTtcclxuICAgICAgICB0aGlzLnRoYW5kbGUgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGRyYXdTY2VuZSgpIHtcclxuICAgICAgICBsZXQgZCA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgbGV0IHQgPSBkLmdldFRpbWUoKTtcclxuICAgICAgICBsZXQgZGlmZiA9IHQgLSB0aGlzLmxhc3RfdDtcclxuICAgICAgICB0aGlzLmxhc3RfdCA9IHQ7XHJcbiAgICAgICAgdGhpcy5zdW1fdCA9IHRoaXMuc3VtX3QgKyBkaWZmO1xyXG5cclxuICAgICAgICAvLyDmuIXnqbpcclxuICAgICAgICB0aGlzLmN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5zY3JlZW5XaWR0aCwgdGhpcy5zY3JlZW5IZWlnaHQpO1xyXG5cclxuICAgICAgICAvL+eVq+eri+aWuemrlFxyXG4gICAgICAgIHZhciBvZmZzZXRNYXRyaXggPSBUcmFuc2Zvcm0ub2Zmc2V0KDAsIDAsIDApO1xyXG4gICAgICAgIHZhciBub3dEZWdyZWUgPSB0aGlzLnN1bV90IC8gMTAwMCAqIDE1ICUgMzYwO1xyXG4gICAgICAgIC8vIHZhciBub3dEZWdyZWUgPSAwO1xyXG5cclxuICAgICAgICB2YXIgcm90YXRlTWF0cml4ID0gVHJhbnNmb3JtLnJvdGF0ZUJ5Wihub3dEZWdyZWUpO1xyXG4gICAgICAgIHZhciBjb21iaW5lTWF0cml4ID0gVHJhbnNmb3JtLnRyYW5zZm9ybVRyYW5zZm9ybShvZmZzZXRNYXRyaXgsIHJvdGF0ZU1hdHJpeCk7XHJcbiAgICAgICAgdGhpcy5ib3gudXBkYXRlKHRoaXMuY2FtZXJhLCBjb21iaW5lTWF0cml4KTtcclxuICAgICAgICB0aGlzLmJveC5kcmF3KHRoaXMuY3R4KTtcclxuXHJcbiAgICAgICAgdmFyIG9mZnNldE1hdHJpeCA9IFRyYW5zZm9ybS5vZmZzZXQoMTUwLCAwLCAwKTtcclxuICAgICAgICB2YXIgcm90YXRlTWF0cml4ID0gVHJhbnNmb3JtLnJvdGF0ZUJ5Wihub3dEZWdyZWUpO1xyXG4gICAgICAgIGNvbWJpbmVNYXRyaXggPSBUcmFuc2Zvcm0udHJhbnNmb3JtVHJhbnNmb3JtKHJvdGF0ZU1hdHJpeCwgb2Zmc2V0TWF0cml4KTtcclxuICAgICAgICB0aGlzLmJveC51cGRhdGUodGhpcy5jYW1lcmEsIGNvbWJpbmVNYXRyaXgpO1xyXG4gICAgICAgIHRoaXMuYm94LmRyYXcodGhpcy5jdHgpO1xyXG4gICAgfVxyXG5cclxuICAgIGtleVByb2MoZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcclxuICAgICAgICBsZXQgS2VwTWFwID1cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHc6IDg3LFxyXG4gICAgICAgICAgICByOiA4MixcclxuXHJcbiAgICAgICAgICAgIGU6IDY5LFxyXG4gICAgICAgICAgICBkOiA2OCxcclxuICAgICAgICAgICAgczogODMsXHJcbiAgICAgICAgICAgIGY6IDcwLFxyXG5cclxuICAgICAgICAgICAgYV91cDogMzgsXHJcbiAgICAgICAgICAgIGFfZG93bjogNDAsXHJcbiAgICAgICAgICAgIGFfbGVmdDogMzcsXHJcbiAgICAgICAgICAgIGFfcmlnaHQ6IDM5XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIG1vdmVTID0gMTtcclxuICAgICAgICB2YXIgcm90YXRlUyA9IDAuMTtcclxuICAgICAgICBzd2l0Y2ggKGV2ZW50LmtleUNvZGUpIHtcclxuICAgICAgICAgICAgY2FzZSBLZXBNYXAudzpcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhLm1vdmVFeWUobW92ZVMsIHRoaXMuY2FtZXJhLnpfYXhpcyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBLZXBNYXAucjpcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhLm1vdmVFeWUoLW1vdmVTLCB0aGlzLmNhbWVyYS56X2F4aXMpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlIEtlcE1hcC5lOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEubW92ZUV5ZShtb3ZlUywgdGhpcy5jYW1lcmEueV9heGlzKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIEtlcE1hcC5kOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEubW92ZUV5ZSgtbW92ZVMsIHRoaXMuY2FtZXJhLnlfYXhpcyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBLZXBNYXAuczpcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhLm1vdmVFeWUoLW1vdmVTLCB0aGlzLmNhbWVyYS54X2F4aXMpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgS2VwTWFwLmY6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYS5tb3ZlRXllKG1vdmVTLCB0aGlzLmNhbWVyYS54X2F4aXMpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlIEtlcE1hcC5hX3VwOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEuYWRkUGl0Y2gocm90YXRlUyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBLZXBNYXAuYV9kb3duOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEuYWRkUGl0Y2goLXJvdGF0ZVMpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlIEtlcE1hcC5hX2xlZnQ6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYS5hZGRZYXcoLXJvdGF0ZVMpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgS2VwTWFwLmFfcmlnaHQ6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYS5hZGRZYXcocm90YXRlUyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsiZnJvbSIsImRpciIsInRoaXMiLCJkZWdyZWVfdG9fUmFkIiwiZCIsIk1hdGgiLCJQSSIsIm51bWJlcl9lcXVhbCIsImEiLCJiIiwiYWJzIiwiZ2V0X2hpdF9zb3J0X2xpc3QiLCJvYmpfbGlzdCIsInJheSIsIm1hcCIsIm9iaiIsImgiLCJoaXQiLCJzIiwiZmlsdGVyIiwiaW5mbyIsImlzX2hpdCIsInNvcnQiLCJ0IiwibGVycCIsImNsaXAiLCJ0cmlhbmdsZSIsIm5lYXJQbGFuZVoiLCJ2X2NsaXAiLCJnZXRDcm9zc1BvaW50IiwidjAiLCJ2MSIsInB6IiwicHYwIiwicCIsInB2MSIsInoiLCJ4IiwieSIsInV2MCIsInV2IiwidXYxIiwidSIsInYiLCJjbGlwX2ZpcnN0X2luIiwicHYyIiwiY2xpcF9maXJzdF9vdXQiLCJjcm9zczEiLCJjcm9zczIiLCJjb3B5IiwidjIiLCJweCIsInB5IiwiVmVjdG9yIiwicmVmbGVjdCIsIkkiLCJOIiwiTCIsImRvdCIsIm11bHRpcGx5IiwiYWRkIiwiQSIsIkIiLCJtaW51cyIsIm11bHRpcGx5MyIsImNyb3NzIiwiZXF1YWwiLCJsZW5ndGgiLCJzcXJ0Iiwibm9ybWFsaXplIiwidGVtcCIsIm5lZ2F0aXZlIiwiY2xvbmUiLCJ1cCIsInplcm8iLCJidWlsZF92ZXJ0ZXgiLCJWZXJ0ZXgiLCJ4QXhpcyIsInlBeGlzIiwiekF4aXMiLCJwb3NpdGlvbiIsInRyYW5zZm9ybVBvaW50IiwidHJhbnNmb3JtIiwicG9pbnQiLCJ2ZWN0b3JYIiwidmVjdG9yWSIsInZlY3RvcloiLCJ0cmFuc2Zvcm1WZWN0b3IiLCJ2ZXJ0ZXgiLCJ0cmFuc2Zvcm1UcmFuc2Zvcm0iLCJpbnB1dFRyYW5zZm9ybSIsIlRyYW5zZm9ybSIsInJvdGF0ZUJ5WiIsImRlZ3JlZSIsInJhZGlhbiIsImMiLCJjb3MiLCJzaW4iLCJyb3RhdGVCeVgiLCJvZmZzZXQiLCJwcm9jZXNzIiwicGNhbWVyYSIsIndvcmxkVHJhbnNmb3JtIiwidjBfdyIsInYxX3ciLCJ2Ml93IiwidjBfYyIsInRvQ2FtZXJhU3BhY2UiLCJ2MV9jIiwidjJfYyIsInYwMSIsInYwMiIsIm5vcm1hbCIsImNlbnRlciIsImNlbnRlcl90b19leWUiLCJUcmlhbmdsZSIsInZfcyIsImkiLCJ0b1NjcmVlblNwYWNlIiwiZHJhdyIsImN0eCIsInRDb3VudCIsImluZGV4IiwibW92ZVRvIiwibGluZVRvIiwidHJpYW5nbGVzIiwicHVzaCIsIm0iLCJyb3RhdGVNYXRyaXgiLCJ1cGRhdGUiLCJjYW1lcmEiLCJ0cmlhbmdsZXNfYWZ0ZXJfY2xpcCIsImNvdW50IiwiayIsIm5ld190cmlhbmdsZSIsImdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiIsInN0cm9rZVN0eWxlIiwiYmVnaW5QYXRoIiwic3Ryb2tlIiwiY29sb3IiLCJzaGFkaW5nIiwiaGl0X2luZm8iLCJkaXJlY3Rpb25fbGlnaHRfZGlyIiwiZGVwdGgiLCJuIiwic3RyZW5ndGgiLCJzaGFkb3dfd2VpZ2h0IiwiaGl0X3BvcyIsImdldF9zaGFkb3dfd2VpZ2h0IiwieWVsbG93IiwiRGlmZnVzZSIsInJlZCIsImdyZWVuIiwiYmx1ZSIsImdyYXkiLCJ3aGl0ZSIsImV5ZSIsImxvb2tfYXQiLCJmb3ZfZGVncmVlIiwic2NyZWVuVyIsInNjcmVlbkgiLCJtb3ZlRXllIiwiaGFsZl9mb3YiLCJ5X3NjYWxlIiwidGFuIiwieF9zY2FsZSIsInJhdGlvIiwiTkRDeCIsIk5EQ3kiLCJoYWxmVyIsInNjcmVlbkNlbnRlclgiLCJoYWxmSCIsInNjcmVlbkNlbnRlclkiLCJ6X2F4aXMiLCJoZWxwX3YiLCJ4X2F4aXMiLCJ5X2F4aXMiLCJhZGRQaXRjaCIsImFkZFlhdyIsImNyZWF0ZV9yYXlfZGlyIiwieF93ZWlnaHQiLCJ5X3dlaWdodCIsImhhbGZfZm92X3JhZCIsInRhbl9oIiwidGFuX3ciLCJkaWZmIiwicmVuZGVyIiwicmVuZGVyX3RhcmdldCIsImhhbGZfcGl4ZWxfb2Zmc2V0IiwibXVsdGlzYW1wbGVfZGlmZiIsInJlbmRlcl9waXhlbCIsInJheV9kaXIiLCJjb2xvcnMiLCJoaXRfc29ydF9saXN0IiwicmVkdWNlIiwiYWNjdW11bGF0b3IiLCJjdXJyZW50IiwiY2FtZXJhSW5kZXhfdmlldyIsImNhbWVyYUluZGV4X2NvbnRyb2wiLCJzY3JlZW5XaWR0aCIsInNjcmVlbkhlaWdodCIsImJveCIsIndpbmRvdyIsIm9ubG9hZCIsImluaXQiLCJkb2N1bWVudCIsIm9ua2V5ZG93biIsImtleVByb2MiLCJjYW52YXMiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwid2lkdGgiLCJoZWlnaHQiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsImdldENvbnRleHQiLCJzdGFydCIsInN0b3AiLCJzdW1fdCIsIkRhdGUiLCJsYXN0X3QiLCJnZXRUaW1lIiwidGhhbmRsZSIsInNldEludGVydmFsIiwiZHJhd1NjZW5lIiwicmVzdW1lIiwiY2xlYXJJbnRlcnZhbCIsImNsZWFyUmVjdCIsIm9mZnNldE1hdHJpeCIsIm5vd0RlZ3JlZSIsImNvbWJpbmVNYXRyaXgiLCJldmVudCIsImtleUNvZGUiXSwic291cmNlUm9vdCI6IiJ9